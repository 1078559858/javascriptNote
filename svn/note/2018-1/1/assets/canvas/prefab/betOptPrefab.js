
// -- user code here --

/* --- start generated code --- */

// Generated by  1.4.4 (Phaser v2.6.2)


/**
 * betOptPrefab.
 * @param {Phaser.Game} aGame A reference to the currently running game.
 * @param {Phaser.Group} aParent The parent Group (or other {@link DisplayObject}) that this group will be added to.
    If undefined/unspecified the Group will be added to the {@link Phaser.Game#world Game World}; if null the Group will not be added to any parent.
 * @param {string} aName A name for this group. Not used internally but useful for debugging.
 * @param {boolean} aAddToStage If true this group will be added directly to the Game.Stage instead of Game.World.
 * @param {boolean} aEnableBody If true all Sprites created with {@link #create} or {@link #createMulitple} will have a physics body created on them. Change the body type with {@link #physicsBodyType}.
 * @param {number} aPhysicsBodyType The physics body type to use when physics bodies are automatically added. See {@link #physicsBodyType} for values.
 */
function betOptPrefab(aGame, aParent, aName, aAddToStage, aEnableBody, aPhysicsBodyType) {
	
	Phaser.Group.call(this, aGame, aParent, aName, aAddToStage, aEnableBody, aPhysicsBodyType);
	var _betBtn = this.game.add.button(0, 0, 'bg', this.clickBet, this, null, 'betChoice1.png', null, null, this);
	_betBtn.data = {
	"idx":1
	};
	
	var _main_png = this.game.add.sprite(55, 17, 'text', 'main.png', this);
	
	var _groupPrice = this.game.add.group(this);
	_groupPrice.position.setTo(44, 166);
	
	var _priceDa = this.game.add.sprite(0, -92, 'text', 'l_d2.png', _groupPrice);
	
	var _priceDian = this.game.add.sprite(39, -55, 'text', 'l_dian.png', _groupPrice);
	
	var _priceX1 = this.game.add.sprite(50, -71, 'text', 'l_9.png', _groupPrice);
	
	var _priceX2 = this.game.add.sprite(73, -71, 'text', 'l_4.png', _groupPrice);
	
	var _priceBei = this.game.add.sprite(95, -75, 'text', 'l_bei.png', _groupPrice);
	
	var _groupPower = this.game.add.group(this);
	
	var _countTotal = this.game.add.text(103, 172, '0', {"font":"bold 24px Arial","fill":"#ffff00"}, _groupPower);
	
	var _countMine = this.game.add.text(103, 137, '0', {"font":"bold 24px Arial","fill":"#ffffff"}, _groupPower);
	
	var _groupFlyText = this.game.add.group(this);
	
	var _groupWin = this.game.add.group(this);
	
	var _guang_png = this.game.add.sprite(-17, -18, 'bg2', 'guang.png', _groupWin);
	
	var _win_png = this.game.add.sprite(44, 8, 'bg2', 'win.png', _groupWin);
	
	
	
	// public fields
	
	this.fBetBtn = _betBtn;
	this.fMain_png = _main_png;
	this.fGroupPrice = _groupPrice;
	this.fPriceDa = _priceDa;
	this.fPriceDian = _priceDian;
	this.fPriceX1 = _priceX1;
	this.fPriceX2 = _priceX2;
	this.fPriceBei = _priceBei;
	this.fCountTotal = _countTotal;
	this.fCountMine = _countMine;
	this.fGuang_png = _guang_png;
	this.fWin_png = _win_png;
	/* --- post-init-begin --- */
	// you can insert code here

	//create Text
	this.setAnchorMiddle(this.fCountMine);
	this.setAnchorMiddle(this.fCountTotal);
	this.setAnchorMiddle(this.fGuang_png);
	/* --- post-init-end --- */
	
	
}

/** @type Phaser.Group */
var betOptPrefab_proto = Object.create(Phaser.Group.prototype);
betOptPrefab.prototype = betOptPrefab_proto;
betOptPrefab.prototype.constructor = betOptPrefab;

/* --- end generated code --- */
// -- user code here --

betOptPrefab.prototype.appearWin = function () {
	this.fGuang_png.visible = true;
	this.fWin_png.visible = true;
};

betOptPrefab.prototype.actionBonusAltas = function (count) {
	count = Number(count);
	count = FormatNumber.symbol(count);
	count = "+" + count;

	var bmpText = this.game.add.bitmapText(200, 100, 'yellow', count, 32);
	bmpText.x = this.fBetBtn.height/2 - bmpText.width/2;
	bmpText.y = this.fBetBtn.height - bmpText.height;
	this.addChild(bmpText);

	var tween = this.game.add.tween(bmpText).to({x:bmpText.x, y:0 }, 1000,
					Phaser.Easing.Exponential.Out, true);

	tween.onComplete.add(function (fSpr, fTween) {
		fSpr.destroy();
	},this);
};

betOptPrefab.prototype.clickBet = function (btn) {
	// if(!gGame.gameScene.isBetting()){
	// ("非投注时间，无法投注！");
	// 	return;
	// }

	this.playerBet(btn.data.idx, gUserInfo.betLevel);
};

betOptPrefab.prototype.disAppearWin = function () {
	this.fGuang_png.visible = false;
	this.fWin_png.visible = false;
};

betOptPrefab.prototype.createInit = function () {
	this.setBetMineText(0);
	this.setBetTotalText(0);
	this.setBonusTimes("green", 0);

	this.disAppearWin();
};

betOptPrefab.prototype.playerBet = function (who, count) {
	this.game.state.states.Net.make2001(who, count);
};

betOptPrefab.prototype.setBetMineText = function (count) {
	this.fCountMine.text = count;
};

betOptPrefab.prototype.setBetTotalText = function (count) {
	this.fCountTotal.text = count;
};

//three\two\one
betOptPrefab.prototype.setBonusTimes = function (type, bonusTimes) {
	if(!bonusTimes){
		this.fGroupPrice.scale.x = 0;
		return;
	}

	bonusTimes = bonusTimes > 10 ? 9.99 : bonusTimes;

	this.fGroupPrice.scale.x = 1;

	var strXiao = "";
	var strDa = "";
	if(type === "three"){
		strXiao = "g_";
		strDa = "g_d";
	}else if(type === "two"){
		strXiao = "l_";
		strDa = "l_d";
	}else{
		strXiao = "z_";
		strDa = "z_d";
	}

	this.fPriceDa.frameName = strDa + Math.floor(bonusTimes) + ".png";
	this.fPriceDian.frameName = strXiao + "dian" + ".png";
	this.fPriceX1.frameName = strXiao + Math.floor(bonusTimes * 100 / 10 % 10) + ".png";
	this.fPriceX2.frameName = strXiao + Math.floor(bonusTimes * 100 % 10) + ".png";
	this.fPriceBei.frameName = strXiao + "bei" + ".png";
};

betOptPrefab.prototype.setAnchorMiddle = function (spr) {
	spr.anchor.set(0.5,0.5);
	spr.x += spr.width/2;
	spr.y += spr.height/2;
};
